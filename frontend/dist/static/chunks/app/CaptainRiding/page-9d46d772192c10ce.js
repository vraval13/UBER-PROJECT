(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[320],{3588:(e,t,s)=>{Promise.resolve().then(s.bind(s,1164))},6046:(e,t,s)=>{"use strict";var l=s(6658);s.o(l,"useRouter")&&s.d(t,{useRouter:function(){return l.useRouter}}),s.o(l,"useSearchParams")&&s.d(t,{useSearchParams:function(){return l.useSearchParams}})},1164:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var l=s(5155),r=s(5565),a=s(8173),i=s.n(a),n=s(2115);s(2069);var o=s(6046);let c=e=>{var t,s;let{ride:a,setFinishRidePanel:i}=e,n=(0,o.useRouter)();async function c(){if(!a||!a._id){console.error("Ride data is not available");return}try{(await fetch("".concat("https://uber-backend-zq0d.onrender.com","/rides/end-ride"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({rideId:a._id})})).ok?n.replace("/CaptainHome"):console.error("Failed to end ride")}catch(e){console.error("Error ending ride:",e)}}return(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("h5",{className:"p-1 text-center w-[93%] absolute top-0",onClick:()=>i(!1),children:(0,l.jsx)("i",{className:"text-3xl text-gray-800 ri-arrow-down-wide-line"})}),(0,l.jsx)("h3",{className:"text-2xl font-semibold mb-5 pt-10",children:"Finish this Ride"}),(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 border-2 border-yellow-400 rounded-lg mt-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(r.default,{src:"/random1.jpeg",alt:"User Image",width:50,height:50,className:"rounded-full"}),(0,l.jsx)("h2",{className:"text-lg font-medium",children:(null==a?void 0:null===(s=a.user)||void 0===s?void 0:null===(t=s.fullname)||void 0===t?void 0:t.firstname)||"Unknown User"})]}),(0,l.jsx)("h5",{className:"text-lg font-semibold",children:"2.2KM"})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-2 mt-5",children:[(0,l.jsxs)("div",{className:"flex items-center gap-5 p-3 border-b-2",children:[(0,l.jsx)("i",{className:"text-lg ri-map-pin-user-fill"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-medium",children:(null==a?void 0:a.pickup)||"N/A"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Pickup Location"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-5 p-3 border-b-2",children:[(0,l.jsx)("i",{className:"text-lg ri-map-pin-2-fill"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-medium",children:(null==a?void 0:a.destination)||"N/A"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Dropoff Location"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-5 p-3",children:[(0,l.jsx)("i",{className:"text-lg ri-currency-line"}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("h3",{className:"text-lg font-medium",children:["â‚¹",(null==a?void 0:a.fare)||"N/A"]}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Cash"})]})]})]}),(0,l.jsx)("div",{className:"mt-10",children:(0,l.jsx)("button",{onClick:c,className:"w-full text-lg flex justify-center bg-green-600 text-white font-semibold p-3 rounded-lg",children:"Finish Ride"})})]})};var d=s(1478),u=s(1762);let x=()=>{(0,o.useRouter)();let e=(0,o.useSearchParams)(),[t,s]=(0,n.useState)(!1),[a,x]=(0,n.useState)(!1),[m,h]=(0,n.useState)(null),f=(0,n.useRef)(null);return(0,n.useEffect)(()=>{let t=e.get("rideId"),s=e.get("pickup"),l=e.get("destination"),r=e.get("fare"),a=e.get("username");t&&s&&l&&r&&a&&h({_id:t,pickup:s,destination:l,fare:r,user:{fullname:{firstname:a}}})},[e]),console.log("Ride Data:",m),(0,n.useEffect)(()=>{f.current&&d.Ay.to(f.current,{transform:t?"translateY(0)":"translateY(100%)",duration:.5})},[t]),(0,l.jsxs)("div",{className:"h-screen relative flex flex-col justify-end",children:[(0,l.jsxs)("div",{className:"fixed p-6 top-0 flex items-center justify-between w-screen",children:[(0,l.jsx)(r.default,{className:"w-16",src:"/uber-driver.svg",alt:"Uber Logo",width:64,height:64}),(0,l.jsx)(i(),{href:"/CaptainHome",className:"h-10 w-10 bg-white flex items-center justify-center rounded-full",children:(0,l.jsx)("i",{className:"text-lg font-medium ri-logout-box-r-line"})})]}),(0,l.jsx)("div",{className:"h-4/5",children:(0,l.jsx)(u.A,{})}),(0,l.jsxs)("div",{className:"h-1/5 p-6 flex items-center justify-between relative bg-yellow-400 pt-10",onClick:()=>s(!0),children:[(0,l.jsx)("h5",{className:"p-1 text-center w-[90%] absolute top-0",children:(0,l.jsx)("i",{className:"text-3xl text-black-200 ri-arrow-up-wide-line"})}),(0,l.jsx)("h4",{className:"text-xl font-semibold",children:"4 KM away"}),(0,l.jsx)("button",{className:"bg-green-600 text-white font-semibold p-3 px-10 rounded-lg",children:"Complete Ride"})]}),(0,l.jsx)("div",{ref:f,className:"fixed w-full z-10 bottom-0 h-screen translate-y-full bg-white px-3 py-10 pt-12",children:(0,l.jsx)(c,{ride:m,setRidePopUpPanel:x,setFinishRidePanel:s})})]})}},1762:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var l=s(5155),r=s(2115),a=s(9047),i=s(2818);let n={width:"100%",height:"100%"},o={lat:-3.745,lng:-38.523},c=()=>{let[e,t]=(0,r.useState)(o);return(0,r.useEffect)(()=>{navigator.geolocation.getCurrentPosition(e=>{let{latitude:s,longitude:l}=e.coords;t({lat:s,lng:l})});let e=navigator.geolocation.watchPosition(e=>{let{latitude:s,longitude:l}=e.coords;t({lat:s,lng:l})});return()=>navigator.geolocation.clearWatch(e)},[]),(0,r.useEffect)(()=>{let e=()=>{navigator.geolocation.getCurrentPosition(e=>{let{latitude:s,longitude:l}=e.coords;console.log("Position updated:",s,l),t({lat:s,lng:l})})};e();let s=setInterval(e,1e3);return()=>clearInterval(s)},[]),(0,l.jsx)(a.aJ,{googleMapsApiKey:i.env.GOOGLE_MAPS_API,children:(0,l.jsx)(a.u6,{mapContainerStyle:n,center:e,zoom:15,children:(0,l.jsx)(a.pH,{position:e})})})}},2069:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[703,84,592,970,173,716,441,517,358],()=>t(3588)),_N_E=e.O()}]);